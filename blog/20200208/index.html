<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png"><link rel="icon" type="image/png" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content=""><meta name="author" content="Regnover"><meta name="keywords" content=""><title>C++ 02 ~ Regnover</title><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.10.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.8.7/css/mdb.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css"><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="/css/main.css"><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><style type="text/css">.banner-bg{background-image:url(https://s2.ax1x.com/2020/02/12/1H1EfP.png);background-position:center;background-repeat:repeat-y;background-size:cover;background-attachment:fixed}</style><meta name="generator" content="Hexo 4.2.0"></head><body class="banner-bg"><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>Regnover</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/">首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/">归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/">分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/">标签</a></li><li class="nav-item"><a class="nav-link" href="/about/">关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a></li></ul></div></div></nav><div class="view intro-2 rgba-black-slight" id="background"><div class="full-bg-img"><div class="mask flex-center"><div class="container text-center white-text fadeInUp"><span class="h2" id="subtitle"></span><br><p class="mt-3"><i class="far fa-calendar-alt"></i> <span class="post-date">2020-02-08&nbsp;|&nbsp;</span> <i class="far fa-chart-bar"></i> <span class="post-count">2k</span>字&nbsp;|&nbsp; <i class="far fa-clock"></i> <span class="post-count">7</span>分钟 <span id="busuanzi_container_page_pv" style="display:none">&nbsp;|&nbsp; <i class="far fa-eye"></i> <span id="busuanzi_value_page_pv"></span>次</span></p></div></div></div></div></header><main id="mainContent" class="rgba-black-slight"><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="py-5 z-depth-3" id="board"><div class="post-content mx-auto" id="post"><div class="markdown-body"><p>第五章 指针、引用和动态空间管理</p><a id="more"></a><h1 id="第五章-指针、引用和动态空间管理"><a href="#第五章-指针、引用和动态空间管理" class="headerlink" title="第五章 指针、引用和动态空间管理"></a>第五章 指针、引用和动态空间管理</h1><h2 id="5-1-指针概述"><a href="#5-1-指针概述" class="headerlink" title="5.1 指针概述"></a>5.1 指针概述</h2><p>指针变量用于存放一个对象在内存中的地址。通过指针变量可以间接访问变量。</p><h3 id="5-1-1-指针变量的定义"><a href="#5-1-1-指针变量的定义" class="headerlink" title="5.1.1 指针变量的定义"></a>5.1.1 指针变量的定义</h3><p>格式：存储类型 数据类型 *指针变量名;</p><h3 id="5-1-2-指针运算符"><a href="#5-1-2-指针运算符" class="headerlink" title="5.1.2 指针运算符"></a>5.1.2 指针运算符</h3><p>&amp; 取地址运算符<br>* 间接引用运算符<br>在指针变量的定义和指针变量的引用中都有*p。但引用指针时的*与定义指针变量时含义是不同，<br>在指针变量的定义中如<code>int \*p;</code>是指一个指向整型的指针，而在引用时*p是指p所指向的变量。</p><h3 id="5-1-3-指针运算"><a href="#5-1-3-指针运算" class="headerlink" title="5.1.3 指针运算"></a>5.1.3 指针运算</h3><ol><li><p>指针的赋值运算：<br>当向指针变量赋值时，赋的值必须时地址常量或变量，不能是普通整数。<br>指针赋值运算常见额有以下几种形式：把一个变量的地址赋予一个指向相同数据类型的指针；<br>把一个指针的值赋予相同数据类型的另外一个指针；把数组的地址赋予指向相同数据类型的指针。</p></li><li><p>指针的算术运算：<br>指针与整数的加减运算：指指针从当前指向位置向前或向后移动几个数据单元。<br>由于指针可以指向不同数据类型，即数据长度不同的数据，所以这种运算的结果值取决于指针所指向的数据类型。该运算通常用于对数据元素进行操作的场合。<br>两个指针相减运算：指在两个指针指向的变量类型相同时相减的结果为两个指针所指的地址之间相隔的数据元素的个数。</p></li><li><p>指针的关系运算：<br>在两个指向相同类型变量的指针之间可以进行各种关系运算，它实现对两个指针所指变量地址值的比较。</p></li></ol><h3 id="5-1-4-const指针"><a href="#5-1-4-const指针" class="headerlink" title="5.1.4 const指针"></a>5.1.4 const指针</h3><ol><li>指向常量的指针<br>格式：<code>const 数据类型 \*指针变量名;</code><br>说明：在程序中不能通过指针来改变它所指向的数据的值，但是指针本身的值可以改变。</li><li>指针常量<br>格式：<code>数据类型 \*const 指针变量名=初始地址值;</code><br>说明：指针本身的值不可改变，但它所指向的数据的值可以改变。</li><li>指向常量的指针常量<br>格式：<code>const 数据类型 \*const 指针变量名=初始地址值;</code><br>说明：指针本身的值不可改变，它所指向的数据的值也不能通过指针改变。</li></ol><h2 id="5-2-指针与数组"><a href="#5-2-指针与数组" class="headerlink" title="5.2 指针与数组"></a>5.2 指针与数组</h2><ol><li><p>数组元素的访问</p><ul><li>地址法：一个数组名代表它的起始地址。地址法即通过地址访问某一数组元素。<br>如定义<code>int a[5];</code>则对数组的第i+1个元素的访问可以用<code>a[i]</code>或<code>*(a+i)</code>。<br>对于二维数组如定义<code>int b[2][3];</code>则b[0],b[1]分别代表第一行和第二行的首地址。<br>所以要访问数组元素b[i][j]可以用下列几种形式：<br><code>*(*(b+i)+j)、*(b[i]+j)、*(b+3*i+j)</code></li><li>指针法：通过指针访问某一数组元素。<br>如定义一个指向数组元素的指针，<code>int a[5],*p=a;</code>，则对数组的第i+1个元素的访问可以用<code>*(p+i)</code>它等价于a[i]。<br>对于二维数组如定义<code>int b[2][3],*q=b[0];</code><br>则访问数组元素b[i][j]可以用以下几种形式：<br><code>*(*(q+i)+j)、*(q[i]+j)、*(q+i)[j]、*(q+3*i+j)、q[i][j]</code></li></ul></li><li><p>数组指针与指针数组</p><ul><li>数组指针：<br>格式：<code>数据类型 (*指针名) [常量表达式];</code><br>说明：数组指针是一个指向一维数组的指针变量。</li><li>指针数组：<br>格式：<code>数据类型 *指针数组名[常量表达式];</code><br>说明：数组元素尾指针的数组，即数组中的每个元素为指向既定的数据类型的指针。</li></ul></li></ol><h2 id="5-3-指针与函数"><a href="#5-3-指针与函数" class="headerlink" title="5.3 指针与函数"></a>5.3 指针与函数</h2><h3 id="5-3-1-指针作为函数参数"><a href="#5-3-1-指针作为函数参数" class="headerlink" title="5.3.1 指针作为函数参数"></a>5.3.1 指针作为函数参数</h3><p>若指针作为某函数的参数，对该函数的调用即为传地址调用。</p><h3 id="5-3-2-指针型函数"><a href="#5-3-2-指针型函数" class="headerlink" title="5.3.2 指针型函数"></a>5.3.2 指针型函数</h3><p>当一个函数的返回值是指针类型时，这个函数就是指针型函数。它的作用是当需要返回大量数据时可以通过指针型函数完成，<br>当然这需要有效组织数据所占的内存空间。这种情况多用于返回数组、字符串等。<br>定义指针函数的函数头的格式为：<code>数据类型 *函数名 (参数表)</code></p><h3 id="5-3-3-函数指针"><a href="#5-3-3-函数指针" class="headerlink" title="5.3.3 函数指针"></a>5.3.3 函数指针</h3><ol><li><p>函数指针就是指向函数的指针。定义格式：<code>数据类型 (*函数指针名) (参数表)</code></p></li><li><p>函数指针变量在使用前应该先给它赋值,格式为：<code>函数指针名=函数名;</code></p></li><li><p>当函数指针指向某函数以后，可以用下列形式调用函数：<code>(*指针变量)(实参表列)</code></p></li><li><p>函数指针数组<br>定义格式：<code>数据类型 (*函数指针名[常量表达式]) (参数表);</code><br>说明：函数指针数组中的每个元素是一个指向既定类型函数的指针。<br>每个元素所指向的函数具有相同的数据类型和相同的参数类型和参数个数。</p></li></ol><h2 id="5-4-指针与字符串"><a href="#5-4-指针与字符串" class="headerlink" title="5.4 指针与字符串"></a>5.4 指针与字符串</h2><p>可以定义一个字符指针，通过指针的指向来访问所需的字符。<br>常用的字符串处理函数：</p><ul><li>strcat()：字符串拼接函数，将字符串s2连接到s1的后面，并返回s1的地址值</li><li>strcmp():字符串比较函数，比较两个字符串s1和s2的大小（如果由参数n，比较前n个字符的大小）。<br>当字符串s1大于、等于或小于字符串s2时，函数返回值分别是正数、零和负数。</li><li>strcpy()：将s2所指向的字符串复制到s1所指向的字符数组中，然后返回s1的地址值</li><li>strlen()：返回字符串s的长度</li></ul><h2 id="5-5-动态存储分配"><a href="#5-5-动态存储分配" class="headerlink" title="5.5 动态存储分配"></a>5.5 动态存储分配</h2><p>动态内存分配的存储空间在堆中，堆也称为自由存储单元。new运算符与delete运算符一起使用，<br>就可以直接进行动态内存的申请和释放（也称为创建和删除）。</p><h3 id="5-5-1-new运算符"><a href="#5-5-1-new运算符" class="headerlink" title="5.5.1 new运算符"></a>5.5.1 new运算符</h3><p>new运算符用于申请所需的内存单元，返回指定类型的一个指针。</p><ol><li>用new动态分配某种类型的变量<br>格式：<code>指针=new 数据类型;</code><br>说明：指针应预先声明，指针指向的数据类型与new后的数据类型相同。若申请成功，则返回分配单元的首地址给指针；否则（比如没有足够的内存空间），则返回0（一个空指针）。</li><li>用new动态分配数组<br>格式：<code>指针=new 数据类型[常量表达式];</code><br>说明：常量表达式给出数组元素的个数，指针指向分配的内存首地址，指针的类型与new后的数据类型相同。</li></ol><h3 id="5-5-2-delete运算符"><a href="#5-5-2-delete运算符" class="headerlink" title="5.5.2 delete运算符"></a>5.5.2 delete运算符</h3><p>delete运算符用于释放new申请到的内存空间。<br>格式一：<code>delete 指针;</code> 作用：释放非数组内存单元。<br>格式二：<code>delete[常量] 指针;</code> 作用：释放数组内存单元。<br>其中，指针时是指向需要释放的内存单元的指针的名字。并且delete只是删除动态内存单元，并不会将指针本身删除。</p><h2 id="5-6-引用的概念及应用"><a href="#5-6-引用的概念及应用" class="headerlink" title="5.6 引用的概念及应用"></a>5.6 引用的概念及应用</h2><p>引用是个变量的别名，当建立引用时，程序用另一个变量或对象（目标）的名字初始化它。<br>引用通常用来做函数的参数或函数的返回值。<br>声明引用的格式为：<code>类型 &amp;引用名=变量名;</code></p><hr></div><br><div><div id="post-tag"><span><i class="iconfont icon-inbox"></i> <a class="hover-with-bg" href="/categories/%E6%96%87%E6%A1%A3">文档</a> &nbsp; </span><span><i class="iconfont icon-tag"></i> <a class="hover-with-bg" href="/tags/cpp">cpp</a></span></div><div id="post-note"><div><strong>本文作者：</strong><a href="/">Regnover</a></div><div><strong>本文链接：</strong><a href="http://regnover.xyz/blog/20200208/">http://regnover.xyz/blog/20200208/</a></div><div><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</div></div><div id="post-nav" class="container"><div class="row"><a href="/blog/20200209/" id="post-nav-prev" class="col"><i class="fas fa-arrow-left"></i> <span class="post-nav-title">C++ 03</span> </a><a href="/blog/20200207/" id="post-nav-next" class="col"><span class="post-nav-title">C++ 01</span> <i class="fas fa-arrow-right"></i></a></div></div></div></div><div class="col-lg-10 mx-auto nopadding-md"><div class="container comments mx-auto" id="comments"></div></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container"><div id="toc"><p class="h4"><i class="far fa-list-alt"></i>&nbsp;目录</p><div id="tocbot"></div></div></div></div></div></main><div id="sidebar" class="sidebar-hide"><span class="sidebar-button sidebar-button-shift" id="toggle-sidebar"><i class="fa fa-arrow-right on" aria-hidden="true"></i></span><div class="sidebar-overlay"></div><div class="sidebar-intrude"><div class="sidebar-avatar"><img src="/img/avatar.jpg" srcset="/img/avatar.jpg" alt="avatar"></div><div class="text-center sidebar-about"><p class="h3 sidebar-author">Regnover</p><p class="sidebar-subtitle"></p><a href="https://github.com/Regnover" class="h4" target="_blank"><i class="fab fa-github" aria-hidden="true"></i> </a>&nbsp;&nbsp; <a href="https://twitter.com" class="h4" target="_blank"><i class="fab fa-twitter" aria-hidden="true"></i> </a>&nbsp;&nbsp; <a href="mailto:example@example.com" class="h4" target="_blank"><i class="fas fa-envelope" aria-hidden="true"></i> </a>&nbsp;&nbsp;</div><div class="sidebar-friend"><p class="h6 sidebar-friend-title"><span class="sidebar-label-left"><i class="fas fa-user-friends"></i></span> <span class="sidebar-label">友情链接</span></p><ul class="list-group"><a href="https://example.com/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; friendname</li></a></ul></div></div></div><a class="z-depth-1" id="scroll-top-button" href="#" role="button"><i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><div id="footerContent" class="rgba-black-slight"><footer class="pt-5"><div class="text-center py-3"><div class="footer-theme"><a href="https://hexo.io" target="_blank" rel="nofollow noopener noreferrer">Hexo</a> theme <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener noreferrer">Fluid</a> mod by <a href="https://github.com/qixa/hexo-theme-fluid-mod" target="_blank" rel="nofollow noopener noreferrer">Julydate</a></div><div class="footer-copyright">©2020&nbsp;Regnover</div><div class="footer-siteview"><span id="busuanzi_container_site_pv" style="display:none">被瞅了<span id="busuanzi_value_site_pv"></span>次 </span><span id="busuanzi_container_site_uv" style="display:none">| 被<span id="busuanzi_value_site_uv"></span>人看爆</span></div><div class="footer-hitokoto"><a id="hitokotoa" href="#" target="_blank" rel="nofollow noopener noreferrer"><span id="hitokoto"></span></a></div></div></footer></div><script src="/lib/popper/popper.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script><script src="https://cdn.staticfile.org/mdbootstrap/4.8.7/js/mdb.min.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script src="https://cdn.staticfile.org/tocbot/4.8.1/tocbot.min.js"></script><script src="/js/post.js"></script><script src="https://cdn.staticfile.org/typed.js/2.0.9/typed.min.js"></script><script type="text/javascript">var typed=new Typed("#subtitle",{strings:["  ","C++ 02&nbsp;"],cursorChar:"_",typeSpeed:70,loop:!1});typed.stop(),$(document).ready(function(){$(".typed-cursor").addClass("h2"),typed.start()})</script><script src="https://cdn.staticfile.org/anchor-js/4.2.0/anchor.min.js"></script><script type="text/javascript">anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))</script><script src="/js/local-search.js"></script><script type="text/javascript">var path="/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){getSearchFile(path),this.onclick=null}</script><script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><script type="text/javascript">var setupFancybox=function(){$("#post img:not(.no-zoom img, img[no-zoom])").each(function(){var t=document.createElement("a");$(t).attr("data-fancybox","gallery"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)})};setupFancybox()</script><script type="text/javascript">$("img.image_random").each(function(){var n=$(this);$.get("//img.xjh.me/random_img.php?return=json",function(i,m){"success"===m&&200===i.result&&(n[0].src=i.img)})})</script><script type="text/javascript">function hitokoto(t){$("#hitokoto").stop().fadeOut(function(){$("#hitokoto").html(t.hitokoto),document.getElementById("hitokotoa").href="https://hitokoto.cn?id="+t.id,$("#hitokoto").stop().fadeIn()})}function getHitokoto(){var t=["a","b","c","d"],o=document.createElement("script");o.type="text/javascript",o.id="hitokotoko_js",o.src="//v1.hitokoto.cn/?encode=json&callback=hitokoto&charset=utf-8&cat="+t[Math.floor(Math.random()*t.length)],$("#hitokoto").append(o)}$(document).ready(function(){getHitokoto()}),setInterval(getHitokoto,1e4)</script><script async src="//cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js"></script><script type="text/javascript">$("#background").removeClass("banner-bg"),$("body").addClass("banner-bg");var postToTopHight=$("#board").offset().top;$(window).scroll(function(){var o=document.body.scrollTop+document.documentElement.scrollTop;postToTopHight<=o?($("#background").removeClass("rgba-black-slight"),$("#mainContent").removeClass("rgba-black-slight"),$("#footerContent").removeClass("rgba-black-slight")):($("#background").addClass("rgba-black-slight"),$("#mainContent").addClass("rgba-black-slight"),$("#footerContent").addClass("rgba-black-slight"))})</script><script type="text/javascript">var originalTitle=document.title;window.onblur=function(){document.title="网页崩溃了~~"},window.onfocus=function(){document.title=originalTitle}</script><script type="text/javascript">console.log("雪花效果 code by kvv.me"),function(){function n(){r.width=window.innerWidth,r.height=window.innerHeight,c=Math.round(window.innerWidth*window.innerHeight/1e4)}var r=document.createElement("canvas"),d=requestAnimationFrame||msRequestAnimationFrame||function(n){setTimeout(n,16)},h=0,c=0,m=[];n(),r.className="snow",document.body.appendChild(r);for(var i=0;i<c;i++)m.push({x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight,radius:4*Math.random()+1,direction:2*Math.random()-.5});addEventListener("resize",n),d(function n(){var i=window.innerWidth,e=window.innerHeight,t=r.getContext("2d");t.clearRect(0,0,i,e),t.fillStyle="rgba(255, 255, 255, 0.7)",t.beginPath(),h+=.01;for(var a=0;a<c;a++){var o=m[a];o&&(t.moveTo(o.x,o.y),t.arc(o.x,o.y,o.radius,0,2*Math.PI,!0),o.y+=Math.cos(h)+o.radius/2,o.x+=Math.sin(h*o.direction),(o.x>i+5||o.x<-5||o.y>e)&&(0<a%3?(m[a].x=Math.random()*i,m[a].y=-10):(0<Math.sin(h*o.direction)?m[a].x=-5:m[a].x=i+5,m[a].y=Math.random()*e)))}t.fill(),d(n)})}()</script></body></html>